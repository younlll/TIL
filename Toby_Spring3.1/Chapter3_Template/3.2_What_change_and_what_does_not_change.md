# 3.2 변하는 것과 변하지 않는 것
## JDBC try/catch/finally 코드의 문제점
* try/catch/finally가 모든 메소드마다 반복되고 중첩해서 사용하고 있는 문제점이 있다
* DAO 메소드가 추가될 때마다 try/catch/finally를 작성해줘야하며 이러한 작업이 반복되는 경우 개발자의 실수로 인해 오류가 발생할 수도 있다
* 앞서 DB connection의 반복을 분리했듯이 다른 성격이긴 하나 이것도 분리를 해볼 수 있다

## 분리와 재사용을 위한 디자인 패턴 적용
* delete, select, insert메소드 별로 변하지 않는 부분을 재사용 할 방법을 생각해보자

### 메소드 추출
* deleteAll() 메소드에서 변하는 부분을 메소드로 빼서 구현한 예제이다
```java
public void deleteAll() throws SQLException {
  ...
  try {
    conn = dataSource.getConnection();
    ps = makeStatement(conn); // 변하는 부분을 메소드로 추출하고 변하지 않는 부분에서 호출하도록 변경
    ps.executeUpdate();
  } catch (SQLException e) 
  ...
}

private PreparedStatement makeStatement(Connection conn) throes SQLException {
  PreparedStatement ps;
  ps = c.preparedStatement("delete from users");
  return ps;
}
```

* 위처럼 분리한 경우 아직 문제가 해결되지 않았다
* 보통 메소드 추출 리팩토링을 적용하는 경우, 분리시킨 메소드를 다른곳에서 재사용 할 수 있어야하는데 이건 반대로 분리시킨 경우이다

### 템플릿 메소드 패턴 적용
